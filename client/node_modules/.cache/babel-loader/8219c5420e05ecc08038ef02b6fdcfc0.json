{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\97150\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\97150\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\97150\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\97150\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\97150\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport { AbstractMaskSystem } from './AbstractMaskSystem.mjs';\nimport { ExtensionType, extensions } from '@pixi/extensions';\nimport { settings } from '@pixi/settings';\nvar StencilSystem = /*#__PURE__*/function (_AbstractMaskSystem) {\n  _inherits(StencilSystem, _AbstractMaskSystem);\n  function StencilSystem(renderer) {\n    var _this;\n    _classCallCheck(this, StencilSystem);\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(StencilSystem).call(this, renderer));\n    _this.glConst = settings.ADAPTER.getWebGLRenderingContext().STENCIL_TEST;\n    return _this;\n  }\n  _createClass(StencilSystem, [{\n    key: \"getStackLength\",\n    value: function getStackLength() {\n      var maskData = this.maskStack[this.maskStack.length - 1];\n      if (maskData) {\n        return maskData._stencilCounter;\n      }\n      return 0;\n    }\n  }, {\n    key: \"push\",\n    value: function push(maskData) {\n      var maskObject = maskData.maskObject;\n      var gl = this.renderer.gl;\n      var prevMaskCount = maskData._stencilCounter;\n      if (prevMaskCount === 0) {\n        this.renderer.framebuffer.forceStencil();\n        gl.clearStencil(0);\n        gl.clear(gl.STENCIL_BUFFER_BIT);\n        gl.enable(gl.STENCIL_TEST);\n      }\n      maskData._stencilCounter++;\n      var colorMask = maskData._colorMask;\n      if (colorMask !== 0) {\n        maskData._colorMask = 0;\n        gl.colorMask(false, false, false, false);\n      }\n      gl.stencilFunc(gl.EQUAL, prevMaskCount, 4294967295);\n      gl.stencilOp(gl.KEEP, gl.KEEP, gl.INCR);\n      maskObject.renderable = true;\n      maskObject.render(this.renderer);\n      this.renderer.batch.flush();\n      maskObject.renderable = false;\n      if (colorMask !== 0) {\n        maskData._colorMask = colorMask;\n        gl.colorMask((colorMask & 1) !== 0, (colorMask & 2) !== 0, (colorMask & 4) !== 0, (colorMask & 8) !== 0);\n      }\n      this._useCurrent();\n    }\n  }, {\n    key: \"pop\",\n    value: function pop(maskObject) {\n      var gl = this.renderer.gl;\n      if (this.getStackLength() === 0) {\n        gl.disable(gl.STENCIL_TEST);\n      } else {\n        var maskData = this.maskStack.length !== 0 ? this.maskStack[this.maskStack.length - 1] : null;\n        var colorMask = maskData ? maskData._colorMask : 15;\n        if (colorMask !== 0) {\n          maskData._colorMask = 0;\n          gl.colorMask(false, false, false, false);\n        }\n        gl.stencilOp(gl.KEEP, gl.KEEP, gl.DECR);\n        maskObject.renderable = true;\n        maskObject.render(this.renderer);\n        this.renderer.batch.flush();\n        maskObject.renderable = false;\n        if (colorMask !== 0) {\n          maskData._colorMask = colorMask;\n          gl.colorMask((colorMask & 1) !== 0, (colorMask & 2) !== 0, (colorMask & 4) !== 0, (colorMask & 8) !== 0);\n        }\n        this._useCurrent();\n      }\n    }\n  }, {\n    key: \"_useCurrent\",\n    value: function _useCurrent() {\n      var gl = this.renderer.gl;\n      gl.stencilFunc(gl.EQUAL, this.getStackLength(), 4294967295);\n      gl.stencilOp(gl.KEEP, gl.KEEP, gl.KEEP);\n    }\n  }]);\n  return StencilSystem;\n}(AbstractMaskSystem);\nStencilSystem.extension = {\n  type: ExtensionType.RendererSystem,\n  name: \"stencil\"\n};\nextensions.add(StencilSystem);\nexport { StencilSystem };","map":null,"metadata":{},"sourceType":"module"}